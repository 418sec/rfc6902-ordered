language: node_js
node_js:
- '8'
branches:
  only:
  - master
  # npm version tags
  - /^v\d+\.\d+\.\d+$/
cache:
  directories:
  - $HOME/.npm
jobs:
  include:
  - before_script:
    - npm run lint
  - if: branch = master AND type = pull_request
    script:
    - git checkout -B $TRAVIS_PULL_REQUEST_BRANCH
    - git remote set-url origin https://$GITHUB_TOKEN@github.com/$TRAVIS_PULL_REQUEST_SLUG.git
    - git fetch
    - git branch -u origin/$TRAVIS_PULL_REQUEST_BRANCH
    - npx https://github.com/kellyselden/ember-cli-update-action.git#semver:^1.3.3 --pull-request-url https://api.github.com/repos/$TRAVIS_REPO_SLUG/pulls/$TRAVIS_PULL_REQUEST --install-command "npm install" --autofix-command "npm run lint -- --fix"
